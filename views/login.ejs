<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body class="login">
<h2>Login</h2>

<% if (message) { %>
    <div class="message <%= messageType === 'success' ? 'message-success' : 'message-error' %>">
        <p><%= message %></p>
    </div>
<% } %>

<form action="/login" method="post">
    <p>When <b>SQL injection is turned on</b>, if user inputs something like "admin' --" (in username) or "' OR 1=1 --" (in any field), query results are shown on the screen.</p>
    <br/>
    <p>When <b>Broken Auth is turned off</b>, user will have to pass CAPTCHA and will have restricted number of times (3) to try to log in before blocking page for 5 minutes.</p>
    <br/>
    <label for="username">Username:</label>
    <input type="text" id="username" name="username" required>

    <label for="password">Password:</label>
    <input type="password" id="password" name="password" required>

    <% if (captcha) { %>
        <label for="captcha">CAPTCHA:</label>
        <img src="<%= captcha %>" alt="CAPTCHA Image" class="captcha-image">
        <input type="text" id="captcha" name="captcha" placeholder="Enter CAPTCHA" required>
    <% } %>

    <button type="submit">Login</button>
</form>
</body>
</html>
